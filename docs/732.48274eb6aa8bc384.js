"use strict";(self.webpackChunkprodapt_weather_app=self.webpackChunkprodapt_weather_app||[]).push([[732],{6732:(ht,S,r)=>{r.r(S),r.d(S,{WeatherModule:()=>it});var m=r(6814),w=r(1303),f=r(95),Y=r(3620),$=r(2181),o=r(2169);const g=(0,o.PH)("[Locations] Load Data",(0,o.Ky)()),x=(0,o.PH)("[Locations] Load Data Success",(0,o.Ky)()),y=(0,o.PH)("[Locations] Load Data Failure",(0,o.Ky)()),v=(0,o.PH)("[Weather] Load Data",(0,o.Ky)()),C=(0,o.PH)("[Weather] Load Data Success",(0,o.Ky)()),D=(0,o.PH)("[Weather] Load Data Failure",(0,o.Ky)()),M=(0,o.ZF)("locations"),P=(0,o.P1)(M,e=>e.data),J=(0,o.ZF)("weather"),Q=(0,o.P1)(J,e=>e.data);var i=r(5313),t=r(5879),u=r(5195),T=r(9481),b=r(3680),H=r(9157),B=r(2032),Z=r(3566);function I(e,s){if(1&e&&(t.TgZ(0,"mat-option",5),t._uU(1),t.qZA()),2&e){const a=s.$implicit;t.Q6J("value",a),t.xp6(1),t.AsE(" ",a.name," - ",a.country," ")}}function K(e,s){if(1&e){const a=t.EpF();t.TgZ(0,"th",19),t.NdJ("click",function(){t.CHM(a);const c=t.oxw(2);return t.KtG(c.reverseSort())}),t._uU(1,"Day"),t.qZA()}}function j(e,s){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const a=s.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,1e3*a.dt,"fullDate"))}}function z(e,s){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Minimum Tempreture"),t.qZA())}function G(e,s){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const a=s.$implicit;t.xp6(1),t.Oqu(a.temp.min)}}function E(e,s){1&e&&(t.TgZ(0,"th",21),t._uU(1,"Maximum Tempreture"),t.qZA())}function R(e,s){if(1&e&&(t.TgZ(0,"td",20),t._uU(1),t.qZA()),2&e){const a=s.$implicit;t.xp6(1),t.Oqu(a.temp.max)}}function X(e,s){1&e&&t._UZ(0,"tr",22)}function k(e,s){1&e&&t._UZ(0,"tr",23)}function q(e,s){if(1&e&&(t.TgZ(0,"div")(1,"mat-card",6)(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"div",7)(7,"mat-card",8)(8,"mat-card-subtitle"),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"span"),t._uU(12),t.qZA(),t.TgZ(13,"span"),t._uU(14),t.qZA(),t.TgZ(15,"span"),t._uU(16),t.qZA()()(),t._UZ(17,"br"),t.TgZ(18,"h3"),t._uU(19,"The next 5 days forcast:"),t.qZA(),t.TgZ(20,"div",9)(21,"table",10),t.ynx(22,11),t.YNc(23,K,2,0,"th",12),t.YNc(24,j,3,4,"td",13),t.BQk(),t.ynx(25,14),t.YNc(26,z,2,0,"th",15),t.YNc(27,G,2,1,"td",13),t.BQk(),t.ynx(28,16),t.YNc(29,E,2,0,"th",15),t.YNc(30,R,2,1,"td",13),t.BQk(),t.YNc(31,X,1,0,"tr",17),t.YNc(32,k,1,0,"tr",18),t.qZA()()()()()),2&e){const a=s.ngIf,n=t.oxw();t.xp6(4),t.hij("",n.selectedLocation.name,"'s weather"),t.xp6(5),t.hij("Today: ",t.xi3(10,8,1e3*a.current.dt,"fullDate"),""),t.xp6(3),t.hij("",a.current.temp," C"),t.xp6(2),t.hij("Feels like ",a.current.feels_like," C"),t.xp6(2),t.Oqu(a.current.weather[0].description),t.xp6(5),t.Q6J("dataSource",n.forcastDataSource),t.xp6(10),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns)}}const V=[{path:"",component:(()=>{class e{constructor(a){this.store=a,this.searchInput=new f.NI,this.forcastDataSource=new i.by,this.displayedColumns=["date","minTemp","maxTemp"]}ngOnInit(){this.watchTheState(),this.searchTextSubscriber(),this.weatherSubscription=this.weatherData$.subscribe(a=>{this.forcastDataSource.data=a?.daily})}watchTheState(){this.locations$=this.store.pipe((0,o.Ys)(P)),this.weatherData$=this.store.pipe((0,o.Ys)(Q))}searchTextSubscriber(){this.searchLocationSubscription=this.searchInput.valueChanges.pipe((0,Y.b)(300),(0,$.h)(a=>!!a)).subscribe(a=>this.store.dispatch(g({searchText:a})))}getWeather(a){this.selectedLocation=a.option.value,this.store.dispatch(v({lat:this.selectedLocation.lat,lon:this.selectedLocation.lon,numberOfDays:5}))}displayLocationName(a){return a?a.name:""}reverseSort(){this.forcastDataSource.data=this.forcastDataSource.data.slice().reverse()}ngOnDestroy(){this.searchLocationSubscription.unsubscribe(),this.weatherSubscription.unsubscribe()}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(o.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-show-weather"]],decls:10,vars:9,consts:[["matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],[1,"mat-elevation-z5","current-weather"],[1,"flex-row"],[1,"temp"],[1,"mat-elevation-z8"],["mat-table","","mat-table","","matSortDisableClear","","matSort","",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","","mat-sort-header","",3,"click",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","minTemp"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","maxTemp"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","",3,"click"],["mat-cell",""],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(n,c){if(1&n&&(t.TgZ(0,"h3"),t._uU(1,"Search for your location:"),t.qZA(),t.TgZ(2,"mat-form-field"),t._UZ(3,"input",0),t.TgZ(4,"mat-autocomplete",1,2),t.NdJ("optionSelected",function(l){return c.getWeather(l)}),t.YNc(6,I,2,3,"mat-option",3),t.ALo(7,"async"),t.qZA()(),t.YNc(8,q,33,11,"div",4),t.ALo(9,"async")),2&n){const d=t.MAs(5);t.xp6(3),t.Q6J("formControl",c.searchInput)("matAutocomplete",d),t.xp6(1),t.Q6J("displayWith",c.displayLocationName),t.xp6(2),t.Q6J("ngForOf",t.lcZ(7,5,c.locations$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,7,c.weatherData$))}},dependencies:[m.sg,m.O5,f.Fj,f.JJ,f.oH,u.a8,u.dn,u.dk,u.$j,u.n5,T.XC,b.ey,T.ZL,H.KE,B.Nt,i.BZ,i.fO,i.as,i.w1,i.Dz,i.nj,i.ge,i.ev,i.XQ,i.Gk,Z.YE,Z.nU,m.Ov,m.uU],styles:["mat-card[_ngcontent-%COMP%]  .mat-card-header-text{width:100%}.current-weather[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#f3f3f3}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;max-width:350px}.flex-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:50%;padding:10px}.flex-row[_ngcontent-%COMP%]   .temp[_ngcontent-%COMP%]{margin-right:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:10px}"]})}return e})()}];let _=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#a=this.\u0275inj=t.cJS({imports:[w.Bz.forChild(V),w.Bz]})}return e})();var tt=r(1481),h=r(5154);const W={data:null,loading:!1,error:null},et=(0,o.Lq)(W,(0,o.on)(g,e=>({...e,loading:!0,error:null})),(0,o.on)(x,(e,{data:s})=>({...e,data:s,loading:!1})),(0,o.on)(y,(e,{error:s})=>({...e,error:s,loading:!1}))),at=(0,o.Lq)(W,(0,o.on)(v,e=>({...e,loading:!0,error:null})),(0,o.on)(C,(e,{data:s})=>({...e,data:s,loading:!1})),(0,o.on)(D,(e,{error:s})=>({...e,error:s,loading:!1})));var L=r(4664),A=r(7398),F=r(6306),U=r(2096),ot=r(9862);const O="https://api.openweathermap.org/",N="abe1eb51289c21c167c66ce790c2fac3";let nt=(()=>{class e{constructor(a){this.http=a}searchLocations(a){return this.http.get(`${O}geo/1.0/direct`,{params:{q:a,limit:5,appid:N}})}getWeather(a,n){const c={lat:a.toString(),lon:n.toString(),exclude:"hourly,minutely,alerts",units:"metric",appid:N};return this.http.get(`${O}data/2.5/onecall`,{params:c})}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(ot.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var rt=r(2939);let st=(()=>{class e{constructor(a){this.snackBar=a}showSuccess(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:["success-toast"]})}showError(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:["error-toast"]})}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(rt.ux))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ct=(()=>{class e{constructor(a,n,c){this.actions$=a,this.openWeatherService=n,this.toastService=c,this.loadLocationsData$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(g),(0,L.w)(({searchText:d})=>this.openWeatherService.searchLocations(d).pipe((0,A.U)(l=>x({data:l})),(0,F.K)(l=>(this.toastService.showError(l),(0,U.of)(y({error:l})))))))),this.loadWeatherData$=(0,h.GW)(()=>this.actions$.pipe((0,h.l4)(v),(0,L.w)(({lat:d,lon:l,numberOfDays:lt})=>this.openWeatherService.getWeather(d,l).pipe((0,A.U)(p=>(this.toastService.showSuccess("Weather data has been loaded successfully"),C({data:{...p,daily:p.daily.slice(1,lt+1)}}))),(0,F.K)(p=>(this.toastService.showError(p),(0,U.of)(D({error:p}))))))))}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(h.eX),t.LFG(nt),t.LFG(st))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})(),it=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#a=this.\u0275inj=t.cJS({imports:[m.ez,_,tt.m,o.Aw.forFeature("locations",et),o.Aw.forFeature("weather",at),h.sQ.forFeature([ct])]})}return e})()}}]);