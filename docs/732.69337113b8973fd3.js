"use strict";(self.webpackChunkprodapt_weather_app=self.webpackChunkprodapt_weather_app||[]).push([[732],{6732:(ft,w,c)=>{c.r(w),c.d(w,{WeatherModule:()=>mt});var u=c(6814),x=c(1303),f=c(95),b=c(3620),P=c(2181),o=c(2169);const g=(0,o.PH)("[Locations] Load Data",(0,o.Ky)()),C=(0,o.PH)("[Locations] Load Data Success",(0,o.Ky)()),y=(0,o.PH)("[Locations] Load Data Failure",(0,o.Ky)()),L=(0,o.PH)("[SelectedLocation] Load Data",(0,o.Ky)()),S=(0,o.PH)("[Weather] Load Data",(0,o.Ky)()),Z=(0,o.PH)("[Weather] Load Data Success",(0,o.Ky)()),D=(0,o.PH)("[Weather] Load Data Failure",(0,o.Ky)()),M=(0,o.ZF)("locations"),N=(0,o.P1)(M,e=>e.data),H=(0,o.ZF)("selectedLocation"),I=(0,o.P1)(H,e=>e.data),J=(0,o.ZF)("weather"),K=(0,o.P1)(J,e=>e.data);var i=c(5313),t=c(5879),m=c(5195),T=c(9481),Q=c(3680),_=c(9157),j=c(2032),W=c(3566);function B(e,s){if(1&e){const a=t.EpF();t.TgZ(0,"mat-option",4),t.NdJ("click",function(){const h=t.CHM(a).$implicit,l=t.oxw();return t.KtG(l.getWeather(h))}),t._uU(1),t.qZA()}if(2&e){const a=s.$implicit;t.Q6J("value",a.name),t.xp6(1),t.AsE(" ",a.name," - ",a.country," ")}}function G(e,s){if(1&e&&(t.TgZ(0,"mat-card-header")(1,"mat-card-title"),t._uU(2),t.qZA()()),2&e){const a=s.ngIf;t.xp6(2),t.hij("",null==a?null:a.name,"'s weather")}}function z(e,s){if(1&e){const a=t.EpF();t.TgZ(0,"th",18),t.NdJ("click",function(){t.CHM(a);const r=t.oxw(2);return t.KtG(r.reverseSort())}),t._uU(1,"Day"),t.qZA()}}function E(e,s){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const a=s.$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,1e3*a.dt,"fullDate"))}}function R(e,s){1&e&&(t.TgZ(0,"th",20),t._uU(1,"Minimum Tempreture"),t.qZA())}function k(e,s){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&e){const a=s.$implicit;t.xp6(1),t.Oqu(a.temp.min)}}function X(e,s){1&e&&(t.TgZ(0,"th",20),t._uU(1,"Maximum Tempreture"),t.qZA())}function q(e,s){if(1&e&&(t.TgZ(0,"td",19),t._uU(1),t.qZA()),2&e){const a=s.$implicit;t.xp6(1),t.Oqu(a.temp.max)}}function V(e,s){1&e&&t._UZ(0,"tr",21)}function tt(e,s){1&e&&t._UZ(0,"tr",22)}function et(e,s){if(1&e&&(t.TgZ(0,"div")(1,"mat-card",5),t.YNc(2,G,3,1,"mat-card-header",3),t.ALo(3,"async"),t.TgZ(4,"mat-card-content")(5,"div",6)(6,"mat-card",7)(7,"mat-card-subtitle"),t._uU(8),t.ALo(9,"date"),t.qZA(),t.TgZ(10,"span"),t._uU(11),t.qZA(),t.TgZ(12,"span"),t._uU(13),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.qZA()()(),t._UZ(16,"br"),t.TgZ(17,"h3"),t._uU(18,"The next 5 days forcast:"),t.qZA(),t.TgZ(19,"div",8)(20,"table",9),t.ynx(21,10),t.YNc(22,z,2,0,"th",11),t.YNc(23,E,3,4,"td",12),t.BQk(),t.ynx(24,13),t.YNc(25,R,2,0,"th",14),t.YNc(26,k,2,1,"td",12),t.BQk(),t.ynx(27,15),t.YNc(28,X,2,0,"th",14),t.YNc(29,q,2,1,"td",12),t.BQk(),t.YNc(30,V,1,0,"tr",16),t.YNc(31,tt,1,0,"tr",17),t.qZA()()()()()),2&e){const a=s.ngIf,n=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,8,n.selectedLocation$)),t.xp6(6),t.hij("Today: ",t.xi3(9,10,1e3*a.current.dt,"fullDate"),""),t.xp6(3),t.hij("",a.current.temp," C"),t.xp6(2),t.hij("Feels like ",a.current.feels_like," C"),t.xp6(2),t.Oqu(a.current.weather[0].description),t.xp6(5),t.Q6J("dataSource",n.forcastDataSource),t.xp6(10),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns)}}const at=[{path:"",component:(()=>{class e{constructor(a){this.store=a,this.searchInput=new f.NI,this.forcastDataSource=new i.by,this.displayedColumns=["date","minTemp","maxTemp"]}ngOnInit(){this.watchTheState(),this.searchTextSubscriber(),this.weatherSubscription=this.weatherData$.subscribe(a=>{this.forcastDataSource.data=a?.daily})}watchTheState(){this.locations$=this.store.pipe((0,o.Ys)(N)),this.weatherData$=this.store.pipe((0,o.Ys)(K)),this.selectedLocation$=this.store.pipe((0,o.Ys)(I)),this.selectedLocationSubscription=this.selectedLocation$.subscribe(a=>{this.searchInput.patchValue(a?.name)})}searchTextSubscriber(){this.searchLocationSubscription=this.searchInput.valueChanges.pipe((0,b.b)(300),(0,P.h)(a=>!!a)).subscribe(a=>this.store.dispatch(g({searchText:a})))}getWeather(a){this.store.dispatch(L({data:a})),this.store.dispatch(S({lat:a.lat,lon:a.lon,numberOfDays:5}))}reverseSort(){this.forcastDataSource.data=this.forcastDataSource.data.slice().reverse()}ngOnDestroy(){this.searchLocationSubscription.unsubscribe(),this.selectedLocationSubscription.unsubscribe(),this.weatherSubscription.unsubscribe()}static#t=this.\u0275fac=function(n){return new(n||e)(t.Y36(o.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-show-weather"]],decls:10,vars:8,consts:[["matInput","",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value","click"],[1,"mat-elevation-z5","current-weather"],[1,"flex-row"],[1,"temp"],[1,"mat-elevation-z8"],["mat-table","","mat-table","","matSortDisableClear","","matSort","",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","","mat-sort-header","",3,"click",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","minTemp"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","maxTemp"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header","",3,"click"],["mat-cell",""],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(n,r){if(1&n&&(t.TgZ(0,"h3"),t._uU(1,"Search for your location:"),t.qZA(),t.TgZ(2,"mat-form-field"),t._UZ(3,"input",0),t.TgZ(4,"mat-autocomplete",null,1),t.YNc(6,B,2,3,"mat-option",2),t.ALo(7,"async"),t.qZA()(),t.YNc(8,et,32,13,"div",3),t.ALo(9,"async")),2&n){const h=t.MAs(5);t.xp6(3),t.Q6J("formControl",r.searchInput)("matAutocomplete",h),t.xp6(3),t.Q6J("ngForOf",t.lcZ(7,4,r.locations$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(9,6,r.weatherData$))}},dependencies:[u.sg,u.O5,f.Fj,f.JJ,f.oH,m.a8,m.dn,m.dk,m.$j,m.n5,T.XC,Q.ey,T.ZL,_.KE,j.Nt,i.BZ,i.fO,i.as,i.w1,i.Dz,i.nj,i.ge,i.ev,i.XQ,i.Gk,W.YE,W.nU,u.Ov,u.uU],styles:["mat-card[_ngcontent-%COMP%]  .mat-card-header-text{width:100%}.current-weather[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#f3f3f3}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;max-width:350px;justify-content:center;align-items:center}.flex-row[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:50%;padding:10px}.flex-row[_ngcontent-%COMP%]   .temp[_ngcontent-%COMP%]{margin-right:10px;display:flex;flex-direction:column;justify-content:center;align-items:center;padding:10px}"]})}return e})()}];let ot=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#a=this.\u0275inj=t.cJS({imports:[x.Bz.forChild(at),x.Bz]})}return e})();var nt=c(1481),d=c(5154);const v={data:null,loading:!1,error:null},st=(0,o.Lq)(v,(0,o.on)(g,e=>({...e,error:null,loading:!0})),(0,o.on)(C,(e,{data:s})=>({...e,data:s,loading:!1})),(0,o.on)(y,(e,{error:s})=>({...e,error:s,loading:!1}))),ct=(0,o.Lq)(v,(0,o.on)(L,(e,{data:s})=>({...e,data:s}))),rt=(0,o.Lq)(v,(0,o.on)(S,e=>({...e,loading:!0,error:null})),(0,o.on)(Z,(e,{data:s})=>({...e,data:s,loading:!1})),(0,o.on)(D,(e,{error:s})=>({...e,error:s,loading:!1})));var A=c(4664),F=c(7398),U=c(6306),$=c(2096),it=c(9862);const O="https://api.openweathermap.org/",Y="abe1eb51289c21c167c66ce790c2fac3";let lt=(()=>{class e{constructor(a){this.http=a}searchLocations(a){return this.http.get(`${O}geo/1.0/direct`,{params:{q:a,limit:5,appid:Y}})}getWeather(a,n){const r={lat:a.toString(),lon:n.toString(),exclude:"hourly,minutely,alerts",units:"metric",appid:Y};return this.http.get(`${O}data/2.5/onecall`,{params:r})}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(it.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ht=c(2939);let dt=(()=>{class e{constructor(a){this.snackBar=a}showSuccess(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:["success-toast"]})}showError(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:["error-toast"]})}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(ht.ux))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ut=(()=>{class e{constructor(a,n,r){this.actions$=a,this.openWeatherService=n,this.toastService=r,this.loadLocationsData$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(g),(0,A.w)(({searchText:h})=>this.openWeatherService.searchLocations(h).pipe((0,F.U)(l=>C({data:l})),(0,U.K)(l=>(this.toastService.showError(l),(0,$.of)(y({error:l})))))))),this.loadWeatherData$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(S),(0,A.w)(({lat:h,lon:l,numberOfDays:pt})=>this.openWeatherService.getWeather(h,l).pipe((0,F.U)(p=>(this.toastService.showSuccess("Weather data has been loaded successfully"),Z({data:{...p,daily:p.daily.slice(1,pt+1)}}))),(0,U.K)(p=>(this.toastService.showError(p),(0,$.of)(D({error:p}))))))))}static#t=this.\u0275fac=function(n){return new(n||e)(t.LFG(d.eX),t.LFG(lt),t.LFG(dt))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})(),mt=(()=>{class e{static#t=this.\u0275fac=function(n){return new(n||e)};static#e=this.\u0275mod=t.oAB({type:e});static#a=this.\u0275inj=t.cJS({imports:[u.ez,ot,nt.m,o.Aw.forFeature("locations",st),o.Aw.forFeature("selectedLocation",ct),o.Aw.forFeature("weather",rt),d.sQ.forFeature([ut])]})}return e})()}}]);