"use strict";(self.webpackChunkprodapt_weather_app=self.webpackChunkprodapt_weather_app||[]).push([[43],{9043:(Zt,x,s)=>{s.r(x),s.d(x,{WeatherModule:()=>yt});var l=s(6814),w=s(1303),n=s(2169),h=s(9221);const d=(0,n.PH)("[Locations] Load Data",(0,n.Ky)()),y=(0,n.PH)("[Locations] Load Data Success",(0,n.Ky)()),T=(0,n.PH)("[Locations] Load Data Failure",(0,n.Ky)()),Z=(0,n.PH)("[SelectedLocation] Load Data",(0,n.Ky)()),m=(0,n.PH)("[Weather] Load Data",(0,n.Ky)()),_=(0,n.PH)("[Weather] Load Data Success",(0,n.Ky)()),C=(0,n.PH)("[Weather] Load Data Failure",(0,n.Ky)()),b=(0,n.ZF)("locations"),N=(0,n.P1)(b,e=>e.data),O=(0,n.ZF)("selectedLocation"),L=(0,n.P1)(O,e=>e.data),$=(0,n.ZF)("weather"),H=(0,n.P1)($,e=>e.data),f="https://api.openweathermap.org/",M=`${f}data/2.5/onecall`,I=`${f}geo/1.0/direct`;var t=s(5879);let P=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-no-data"]],decls:2,vars:0,consts:[[1,"no-data"],["src","./assets/imgs/no-data.svg"]],template:function(o,i){1&o&&(t.TgZ(0,"div",0),t._UZ(1,"img",1),t.qZA())},styles:[".no-data[_ngcontent-%COMP%]{width:50%;align-items:center;display:block;margin:auto}"]})}return e})();var D=s(3566),u=s(6223),B=s(3620),Q=s(2181),A=s(9481),J=s(3680),R=s(2032),g=s(1941),K=s(617);function j(e,c){if(1&e){const a=t.EpF();t.TgZ(0,"mat-option",5),t.NdJ("click",function(){const r=t.CHM(a).$implicit,v=t.oxw();return t.KtG(v.setSelectedLocation(r))}),t._uU(1),t.qZA()}if(2&e){const a=c.$implicit;t.Q6J("value",a.name),t.xp6(1),t.AsE(" ",a.name," - ",a.country," ")}}let z=(()=>{class e{constructor(a){this.store=a,this.searchInput=new u.NI}ngOnInit(){this.watchTheState(),this.searchTextSubscriber()}watchTheState(){this.locations$=this.store.pipe((0,n.Ys)(N)),this.selectedLocation$=this.store.pipe((0,n.Ys)(L)),this.selectedLocationSubscription=this.selectedLocation$.subscribe(a=>{this.searchInput.patchValue(a?.name)})}searchTextSubscriber(){this.searchInputSubscription=this.searchInput.valueChanges.pipe((0,B.b)(300),(0,Q.h)(a=>!!a)).subscribe(a=>{this.store.dispatch(d({searchText:a}))})}setSelectedLocation(a){this.store.dispatch(Z({data:a}))}ngOnDestroy(){this.searchInputSubscription?.unsubscribe(),this.selectedLocationSubscription?.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(n.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-locations-search"]],decls:10,vars:5,consts:[["appearance","fill",1,"search"],["matPrefix",""],["matInput","","type","text","placeholder","Search for your city",3,"formControl","matAutocomplete"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"]],template:function(o,i){if(1&o&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2,"Search for your city"),t.qZA(),t.TgZ(3,"mat-icon",1),t._uU(4,"search"),t.qZA(),t._UZ(5,"input",2),t.TgZ(6,"mat-autocomplete",null,3),t.YNc(8,j,2,3,"mat-option",4),t.ALo(9,"async"),t.qZA()()),2&o){const r=t.MAs(7);t.xp6(5),t.Q6J("formControl",i.searchInput)("matAutocomplete",r),t.xp6(3),t.Q6J("ngForOf",t.lcZ(9,3,i.locations$))}},dependencies:[l.sg,u.Fj,u.JJ,u.oH,A.XC,J.ey,A.ZL,R.Nt,g.KE,g.hX,g.qo,K.Hw,l.Ov],styles:[".search[_ngcontent-%COMP%]{width:100%}"]})}return e})();function G(e,c){if(1&e&&(t.TgZ(0,"div")(1,"h1",18),t._uU(2),t.qZA(),t.TgZ(3,"h4",19),t._uU(4),t.ALo(5,"date"),t.TgZ(6,"span"),t._uU(7),t.qZA()(),t.TgZ(8,"h1",20),t._uU(9),t._UZ(10,"img",21),t.qZA(),t.TgZ(11,"span",22),t._uU(12,"Feels like "),t.TgZ(13,"b"),t._uU(14),t.qZA(),t._uU(15," - "),t.qZA(),t.TgZ(16,"span",22),t._uU(17," Humidity: "),t.TgZ(18,"b"),t._uU(19),t.qZA()()()),2&e){const a=c.ngIf,o=t.oxw().ngIf,i=t.oxw();t.xp6(2),t.AsE("",null==a?null:a.name,", ",a.country,""),t.xp6(2),t.hij("",t.xi3(5,8,1e3*o.current.dt,"EEE, MMM d h:mm a")," - "),t.xp6(3),t.Oqu(o.current.weather[0].description),t.xp6(2),t.hij(" ",i.roundTemp(o.current.temp),"\xb0 "),t.xp6(1),t.Q6J("src",i.imgPath+o.current.weather[0].icon+".png",t.LSH),t.xp6(4),t.hij("",i.roundTemp(o.current.feels_like),"\xb0"),t.xp6(5),t.Oqu(o.current.humidity)}}function q(e,c){if(1&e){const a=t.EpF();t.TgZ(0,"th",23),t.NdJ("click",function(){t.CHM(a);const i=t.oxw(2);return t.KtG(i.reverseSort())}),t._uU(1,"Day"),t.qZA()}}function k(e,c){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const a=c.$implicit;t.xp6(1),t.hij("",t.xi3(2,1,1e3*a.dt,"EEE, MMM d")," ")}}function X(e,c){1&e&&(t.TgZ(0,"th",25),t._uU(1,"Status"),t.qZA())}function V(e,c){if(1&e&&(t.TgZ(0,"td",24),t._UZ(1,"img",21),t._uU(2),t.qZA()),2&e){const a=c.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("src",o.imgPath+a.weather[0].icon+".png",t.LSH),t.xp6(1),t.hij(" ",a.weather[0].description," ")}}function tt(e,c){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Max temp"),t.qZA())}function et(e,c){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const a=c.$implicit,o=t.oxw(2);t.xp6(1),t.hij("",o.roundTemp(a.temp.max),"\xb0")}}function at(e,c){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Min temp"),t.qZA())}function ot(e,c){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const a=c.$implicit,o=t.oxw(2);t.xp6(1),t.hij("",o.roundTemp(a.temp.min),"\xb0")}}function nt(e,c){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Humidity"),t.qZA())}function ct(e,c){if(1&e&&(t.TgZ(0,"td",24),t._uU(1),t.qZA()),2&e){const a=c.$implicit;t.xp6(1),t.Oqu(a.humidity)}}function st(e,c){1&e&&t._UZ(0,"tr",27)}function it(e,c){1&e&&t._UZ(0,"tr",28)}function rt(e,c){if(1&e&&(t.TgZ(0,"div")(1,"div",2),t.YNc(2,G,20,11,"div",3),t.ALo(3,"async"),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"div",4)(6,"h2"),t._uU(7,"5 days forcast:"),t.qZA(),t.TgZ(8,"div",5)(9,"table",6),t.ynx(10,7),t.YNc(11,q,2,0,"th",8),t.YNc(12,k,3,4,"td",9),t.BQk(),t.ynx(13,10),t.YNc(14,X,2,0,"th",11),t.YNc(15,V,3,2,"td",9),t.BQk(),t.ynx(16,12),t.YNc(17,tt,2,0,"th",13),t.YNc(18,et,2,1,"td",9),t.BQk(),t.ynx(19,14),t.YNc(20,at,2,0,"th",13),t.YNc(21,ot,2,1,"td",9),t.BQk(),t.ynx(22,15),t.YNc(23,nt,2,0,"th",13),t.YNc(24,ct,2,1,"td",9),t.BQk(),t.YNc(25,st,1,0,"tr",16),t.YNc(26,it,1,0,"tr",17),t.qZA()()()()),2&e){const a=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,4,a.selectedLocation$)),t.xp6(7),t.Q6J("dataSource",a.forcastDataSource),t.xp6(16),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns)}}function ht(e,c){1&e&&t._UZ(0,"app-no-data")}const lt=[{path:"",component:(()=>{class e{constructor(a){this.store=a,this.forcastDataSource=new h.by,this.displayedColumns=["date","status","minTemp","maxTemp","humidity"],this.imgPath=`${f}img/w/`}ngOnInit(){this.watchTheState()}watchTheState(){this.weatherData$=this.store.pipe((0,n.Ys)(H)),this.weatherDataSubscription=this.weatherData$.subscribe(a=>{this.forcastDataSource.data=a?.daily}),this.selectedLocation$=this.store.pipe((0,n.Ys)(L)),this.selectedLocationSubscription=this.selectedLocation$.subscribe(a=>{this.store.dispatch(m({lat:a.lat,lon:a.lon,numberOfDays:5}))})}roundTemp(a){return Math.round(a)}reverseSort(){this.forcastDataSource.data=this.forcastDataSource.data.slice().reverse()}ngOnDestroy(){this.weatherDataSubscription?.unsubscribe(),this.selectedLocationSubscription?.unsubscribe()}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(n.yh))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-show-weather"]],decls:5,vars:4,consts:[[4,"ngIf","ngIfElse"],["elseBlock",""],[1,"container"],[4,"ngIf"],[1,"forcast"],[1,"mat-elevation-z8"],["mat-table","","mat-table","","matSortDisableClear","","matSort","",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","","mat-sort-header","",3,"click",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","maxTemp"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","minTemp"],["matColumnDef","humidity"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"city"],[1,"date","text-danger"],[1,"temp"],["alt","Weather Icon",3,"src"],[1,"feels-like"],["mat-header-cell","","mat-sort-header","",3,"click"],["mat-cell",""],["mat-header-cell","","mat-sort-header",""],["mat-header-cell",""],["mat-header-row",""],["mat-row",""]],template:function(o,i){if(1&o&&(t._UZ(0,"app-locations-search"),t.YNc(1,rt,27,6,"div",0),t.ALo(2,"async"),t.YNc(3,ht,1,0,"ng-template",null,1,t.W1O)),2&o){const r=t.MAs(4);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,2,i.weatherData$))("ngIfElse",r)}},dependencies:[l.O5,P,h.BZ,h.fO,h.as,h.w1,h.Dz,h.nj,h.ge,h.ev,h.XQ,h.Gk,D.YE,D.nU,z,l.Ov,l.uU],styles:[".city[_ngcontent-%COMP%]{font-size:30px;font-weight:700}.date[_ngcontent-%COMP%]{margin-top:-15px}.temp[_ngcontent-%COMP%]{font-size:40px;margin-top:20px;font-weight:700}.feels-like[_ngcontent-%COMP%]{font-size:20px;color:#7c7c7c;font-weight:400}.forcast[_ngcontent-%COMP%]{margin-top:30px}"]})}return e})()}];let pt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#a=this.\u0275inj=t.cJS({imports:[w.Bz.forChild(lt),w.Bz]})}return e})();var ut=s(9970),p=s(5154);const S={data:null,loading:!1,error:null},dt=(0,n.Lq)(S,(0,n.on)(d,e=>({...e,error:null,loading:!0})),(0,n.on)(y,(e,{data:c})=>({...e,data:c,loading:!1})),(0,n.on)(T,(e,{error:c})=>({...e,error:c,loading:!1}))),mt=(0,n.Lq)(S,(0,n.on)(Z,(e,{data:c})=>({...e,data:c}))),ft=(0,n.Lq)(S,(0,n.on)(m,e=>({...e,error:null,loading:!0})),(0,n.on)(_,(e,{data:c})=>({...e,data:c,loading:!1})),(0,n.on)(C,(e,{error:c})=>({...e,error:c,loading:!1})));var W=s(4664),U=s(7398),E=s(6306),F=s(2096),gt=s(9862);const Y="abe1eb51289c21c167c66ce790c2fac3";let St=(()=>{class e{constructor(a){this.http=a}searchLocations(a){return this.http.get(I,{params:{q:a,limit:5,appid:Y}})}getWeather(a,o){const i={lat:a.toString(),lon:o.toString(),exclude:"hourly,minutely,alerts",units:"metric",appid:Y};return this.http.get(M,{params:i})}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(gt.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var vt=s(7707);let xt=(()=>{class e{constructor(a){this.snackBar=a}showSuccess(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:["success-toast"]})}showError(a){this.snackBar.open(a,"Close",{duration:3e3,panelClass:["error-toast"]})}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(vt.ux))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),wt=(()=>{class e{constructor(a,o,i){this.actions$=a,this.openWeatherService=o,this.toastService=i,this.loadLocationsData$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(d),(0,W.w)(({searchText:r})=>this.searchLocationsEffect(r)))),this.loadWeatherData$=(0,p.GW)(()=>this.actions$.pipe((0,p.l4)(m),(0,W.w)(({lat:r,lon:v,numberOfDays:Tt})=>this.loadWeatherEffect(r,v,Tt))))}searchLocationsEffect(a){return this.openWeatherService.searchLocations(a).pipe((0,U.U)(o=>y({data:o})),(0,E.K)(o=>(this.toastService.showError(o),(0,F.of)(T({error:o})))))}loadWeatherEffect(a,o,i){return this.openWeatherService.getWeather(a,o).pipe((0,U.U)(r=>(this.toastService.showSuccess("Weather data has been loaded successfully"),_({data:{...r,daily:r.daily.slice(1,i+1)}}))),(0,E.K)(r=>(this.toastService.showError(r),(0,F.of)(C({error:r})))))}static#t=this.\u0275fac=function(o){return new(o||e)(t.LFG(p.eX),t.LFG(St),t.LFG(xt))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})(),yt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#a=this.\u0275inj=t.cJS({imports:[l.ez,pt,ut.m,n.Aw.forFeature("locations",dt),n.Aw.forFeature("selectedLocation",mt),n.Aw.forFeature("weather",ft),p.sQ.forFeature([wt])]})}return e})()}}]);